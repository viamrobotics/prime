import{S as H,i as X,a as K,b as B,f as l,n as Q,e as Y,c as b,d as Z,r as $,h as ee,j as te,o as ne,y as oe,z as se,A as ie}from"./preview-dc6b03ff.js";import{d as ae}from"./dispatch-33707423.js";import{h as I}from"./boolean-1ceedbab.js";import{h as N}from"./math-a9ba36ad.js";import"./iframe-7b1e4bad.js";import"../sb-preview/runtime.mjs";const re="0.37.1",h=`https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/${re}`,v=[],R=(s,e)=>`http://definitions/${s}-${e}.json`,F=(s="")=>s.split("/").pop(),ce=(s,e)=>{var o,i;for(const a of Object.values(e.properties??[]))a.type==="array"&&((o=a.items)!=null&&o.type)?a.description=`"array" of type "${(i=a.items)==null?void 0:i.type}"`:a.type==="array"?a.description='"array" of type "object"':a.description=`"${a.type}"`;return JSON.parse(JSON.stringify(e),(a,r)=>{if(a==="$ref")return R(s,F(r));if(a!=="$schema")return r})},le=(s,e,o)=>{const{$ref:i,definitions:a={}}=e;for(const[r,g]of Object.entries(a))v.push({uri:R(s,r),schema:ce(s,g),...F(i)===r?{fileMatch:o}:void 0});window.monaco.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:v})},de=(s,e)=>v.findIndex(({uri:o})=>o===R(s,e)),me=(s,e)=>{let o=!1;const{definitions:i={}}=e;for(const a of Object.keys(i)){const r=de(s,a);v.splice(r,1),o=!0}o&&window.monaco.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:v})},W={addSchemas:le,removeSchemas:me},ue=/\s+|\r?\n|\r/g,V=s=>s.replaceAll(ue,"");let j="uninitialized";const A=new Set,fe=s=>{if(j==="loaded")return s(window.monaco);if(A.add(s),j==="loading")return;j="loading";const e=URL.createObjectURL(new Blob([`
    self.MonacoEnvironment = {
      baseUrl: '${h}/min/'
    };
    importScripts('${h}/min/vs/base/worker/workerMain.js');
    importScripts('${h}/min/vs/language/json/jsonWorker.js');
  `],{type:"text/javascript"})),o=()=>{window.require.config({paths:{vs:`${h}/min/vs`}}),window.MonacoEnvironment={getWorkerUrl:()=>e},window.require(["vs/editor/editor.main"],()=>{for(const i of A)i(window.monaco);j="loaded"})};{const i=document.createElement("script");i.addEventListener("load",o),i.async=!0,i.src=`${h}/min/vs/loader.js`,document.head.append(i)}};function he(s){let e,o,i;return{c(){e=Y("div"),this.c=b,Z(e,"class","w-full h-full relative isolate")},m(a,r){B(a,e,r),s[12](e),o||(i=$(e,"input",s[1]),o=!0)},p:b,i:b,o:b,d(a){a&&ee(e),s[12](null),o=!1,i()}}}function ge(s,e,o){let{value:i=""}=e,{previous:a=""}=e,{language:r}=e,{theme:g="vs"}=e,{readonly:M="false"}=e,{minimap:S="false"}=e,{schema:m=""}=e,{variant:k="default"}=e;const p=ae();te();let O,D,w,u,c,n,y;const x=document.createElement("link");x.rel="stylesheet",x.href=`${h}/min/vs/editor/editor.main.min.css`,ne().shadowRoot.append(x);const _=()=>{if(!n)return;const t=n.getModel();t==null||t.dispose();let d;if(w){const f=String(N(m)),E=`http://${f}.json/`,L=window.monaco.Uri.parse(E);W.removeSchemas(f,w),W.addSchemas(f,w,[L.toString()]),d=window.monaco.editor.createModel(i,r,L)}else d=window.monaco.editor.createModel(i,r);p("update-model",{model:d}),n.setModel(d)},q=()=>{const t=c==null?void 0:c.getModel();t==null||t.modified.dispose(),t==null||t.original.dispose(),c.setModel({original:window.monaco.editor.createModel(a,"json"),modified:window.monaco.editor.createModel(i,"json")})},J=t=>{t instanceof InputEvent&&(t.preventDefault(),t.stopImmediatePropagation())},z=()=>({value:i,language:r,theme:g,readOnly:O,minimap:{enabled:D},scrollbar:{verticalScrollbarSize:3,horizontalScrollbarSize:3,vertical:"auto",horizontal:"auto",alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1}),P=()=>{o(10,c=window.monaco.editor.createDiffEditor(u,{...z(),readOnly:!0})),c.setModel({original:window.monaco.editor.createModel(a,r),modified:window.monaco.editor.createModel(i,r)})},T=t=>{if(k==="diff")return P();o(11,n=t.editor.create(u,z())),n.onDidChangeModelContent(()=>{p("input",{value:n==null?void 0:n.getValue()})}),n.onDidBlurEditorWidget(()=>{p("blur",{value:n==null?void 0:n.getValue()}),C()}),n.layout(),_(),C()},C=()=>{const t=window.monaco.editor.getModelMarkers({}),d=N(m),f=t.filter(E=>E.resource.authority===`${d}.json`);p("markers",{markers:f})},U=()=>{if(!y&&n&&(y=new ResizeObserver(()=>{n==null||n.layout()})),y){const t=(n==null?void 0:n.getDomNode())??u;y.observe(t)}};oe(()=>{fe(T)}),se(()=>{const t=n==null?void 0:n.getModel();t==null||t.dispose(),c==null||c.dispose(),n==null||n.dispose(),y.disconnect(),p("destroy")});function G(t){ie[t?"unshift":"push"](()=>{u=t,o(0,u)})}return s.$$set=t=>{"value"in t&&o(2,i=t.value),"previous"in t&&o(3,a=t.previous),"language"in t&&o(4,r=t.language),"theme"in t&&o(5,g=t.theme),"readonly"in t&&o(6,M=t.readonly),"minimap"in t&&o(7,S=t.minimap),"schema"in t&&o(8,m=t.schema),"variant"in t&&o(9,k=t.variant)},s.$$.update=()=>{if(s.$$.dirty&256&&(w=m?JSON.parse(m):void 0),s.$$.dirty&64&&(O=I(M,"readonly")),s.$$.dirty&128&&(D=I(S,"minimap")),s.$$.dirty&3076){if(c)q(),U();else if(n){_();const t=(n==null?void 0:n.getValue())??"";if(i!==void 0){const d=V(i);V(t)!==d&&(n==null||n.setValue(i),n==null||n.layout())}U()}}},[u,J,i,a,r,g,M,S,m,k,c,n,G]}class pe extends H{constructor(e){super();const o=document.createElement("style");o.textContent=":host{display:contents !important}",this.shadowRoot.appendChild(o),X(this,{target:this.shadowRoot,props:K(this.attributes),customElement:!0},ge,he,Q,{value:2,previous:3,language:4,theme:5,readonly:6,minimap:7,schema:8,variant:9},null),e&&(e.target&&B(e.target,this,e.anchor),e.props&&(this.$set(e.props),l()))}static get observedAttributes(){return["value","previous","language","theme","readonly","minimap","schema","variant"]}get value(){return this.$$.ctx[2]}set value(e){this.$$set({value:e}),l()}get previous(){return this.$$.ctx[3]}set previous(e){this.$$set({previous:e}),l()}get language(){return this.$$.ctx[4]}set language(e){this.$$set({language:e}),l()}get theme(){return this.$$.ctx[5]}set theme(e){this.$$set({theme:e}),l()}get readonly(){return this.$$.ctx[6]}set readonly(e){this.$$set({readonly:e}),l()}get minimap(){return this.$$.ctx[7]}set minimap(e){this.$$set({minimap:e}),l()}get schema(){return this.$$.ctx[8]}set schema(e){this.$$set({schema:e}),l()}get variant(){return this.$$.ctx[9]}set variant(e){this.$$set({variant:e}),l()}}customElements.define("v-code-editor",pe);export{pe as default};
//# sourceMappingURL=code-editor-917c9ab5.js.map
