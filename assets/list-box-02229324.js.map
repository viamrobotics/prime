{"version":3,"file":"list-box-02229324.js","sources":["../../src/elements/list-box.svelte"],"sourcesContent":["<svelte:options immutable tag=\"v-list-box\" />\n\n<script lang=\"ts\">\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n// disabled to pass untyped object to cx library in template\n\nimport cx from 'classnames';\nimport { afterUpdate } from 'svelte';\n\nimport { dispatcher } from '../lib/dispatch';\nimport { addStyles } from '../lib/index';\nimport { htmlToBoolean } from '../lib/boolean';\n\nexport let disabled: string;\nexport let left = '';\nexport let right = '';\nexport let leftlabel = '';\nexport let rightlabel = '';\nexport let height = '200px';\nexport let suffix = '';\n\nconst dispatch = dispatcher();\n\ntype ListBoxSide = 'left' | 'right';\n\ntype ListBoxOption = {\n  value: string;\n  selected: boolean;\n  suffix?: string;\n};\n\ntype Options = {\n  left: ListBoxOption[];\n  right: ListBoxOption[];\n};\n\nconst LEFT = 'left';\nconst RIGHT = 'right';\n\nlet isDisabled: boolean;\n// needs to be calculated on initial render\nlet displaySuffix = htmlToBoolean(suffix, 'suffix');\n\n$: isDisabled = htmlToBoolean(disabled, 'disabled');\n$: displaySuffix = htmlToBoolean(suffix, 'suffix');\n\nconst generateOption = (initial: string): ListBoxOption => {\n  if (displaySuffix) {\n    const split = initial.split(' ');\n    return { value: split[0] ?? '', suffix: split[1] ?? '', selected: false };\n  }\n\n  return { value: initial, selected: false };\n};\n\nlet options = {\n  left: left ? left.split(',').map((val) => generateOption(val)) : [],\n  right: right ? right.split(',').map((val) => generateOption(val)) : [],\n};\n\n// when new values are added, we want to update the state of options to include those values\nconst addNewData = () => {\n  const allValues = new Set([\n    ...options.left.map((opt) => opt.value),\n    ...options.right.map((opt) => opt.value),\n  ]);\n  const newLeftOptions = left\n    ? left\n        .split(',')\n        .map((val) => generateOption(val))\n        .filter((opt) => !allValues.has(opt.value))\n    : [];\n  const newRightOptions = right\n    ? right\n        .split(',')\n        .map((val) => generateOption(val))\n        .filter((opt) => !allValues.has(opt.value))\n    : [];\n\n  const newOptions = {\n    left: [...options.left, ...newLeftOptions],\n    right: [...options.right, ...newRightOptions],\n  };\n\n  options = newOptions;\n};\n\nafterUpdate(addNewData);\naddStyles();\n\nconst handleOptionClick = (option: ListBoxOption, side: ListBoxSide) => {\n  if (isDisabled) return;\n\n  option.selected = !option.selected;\n  options = { ...options };\n\n  dispatch('option-click', {\n    target: { ...option, side },\n  });\n};\n\nconst handleMoveClick = (target: ListBoxSide) => {\n  if (isDisabled) return;\n\n  const source = target === LEFT ? RIGHT : LEFT;\n\n  const newOptions: Options = {\n    left: [],\n    right: [],\n  };\n\n  for (const option of options[source]) {\n    if (option.selected) {\n      newOptions[target].push({ ...option, selected: false });\n    } else {\n      newOptions[source].push(option);\n    }\n  }\n\n  options[source] = newOptions[source];\n  options[target] = [...options[target], ...newOptions[target]];\n  options = { ...options };\n\n  // copy object to avoid any potential pass-by-reference issues\n  dispatch('move', {\n    options: JSON.parse(JSON.stringify(options)) as Options,\n  });\n};\n</script>\n\n<div\n  class={cx('w-full grid grid-cols-[1fr_32px_1fr] gap-8 items-center p-2', {\n    '!text-black/50': isDisabled,\n  })}\n>\n  <div\n    class=\"w-full flex flex-col gap-2 self-stretch\"\n    style={`height: ${height};`}\n  >\n    <span class=\"text-xs text-subtle-1\">{leftlabel}</span>\n    <div\n      class=\"border border-medium grow p-2 bg-white flex flex-col overflow-auto\"\n    >\n      {#if options.left.length > 0}\n        {#each options.left as option}\n          <button\n            class={cx('flex items-center px-2 py text-sm', {\n              'bg-focus/highlight': option.selected,\n            })}\n            on:click={() => handleOptionClick(option, LEFT)}\n          >\n            <input\n              type=\"checkbox\"\n              checked={option.selected}\n              disabled={isDisabled}\n            />\n            <span class=\"px-4\">{option.value}</span>\n            {#if displaySuffix && option.suffix}\n              <span class=\"text-subtle-2\">{option.suffix}</span>\n            {/if}\n          </button>\n        {/each}\n      {:else}\n        <slot name=\"left-empty\" />\n      {/if}\n    </div>\n  </div>\n  <div class=\"flex flex-col gap-4\">\n    <button\n      class={cx(\n        'rotate-90 border border-black h-8 w-8 flex items-center justify-center cursor-pointer hover:scale-105 bg-white',\n        { 'border-black/50': isDisabled }\n      )}\n      data-testid=\"move-right\"\n      on:click={() => handleMoveClick(RIGHT)}\n    >\n      <i class=\"icon-arrow-up\" />\n    </button>\n    <button\n      class={cx(\n        '-rotate-90 border border-black h-8 w-8 flex items-center justify-center cursor-pointer hover:scale-105 bg-white',\n        { 'border-black/50': isDisabled }\n      )}\n      on:click={() => handleMoveClick(LEFT)}\n      data-testid=\"move-left\"\n    >\n      <i class=\"icon-arrow-up\" />\n    </button>\n  </div>\n  <div\n    class=\"w-full flex flex-col gap-2 self-stretch\"\n    style={`height: ${height};`}\n  >\n    <span class=\"text-xs text-subtle-2\">{rightlabel}</span>\n    <div\n      class=\"border border-medium grow p-2 bg-white flex flex-col overflow-auto\"\n    >\n      {#if options.right.length > 0}\n        {#each options.right as option}\n          <button\n            class={cx('flex items-center px-2 py text-sm', {\n              'bg-focus/highlight': option.selected,\n            })}\n            on:click={() => handleOptionClick(option, RIGHT)}\n          >\n            <input\n              type=\"checkbox\"\n              checked={option.selected}\n              disabled={isDisabled}\n            />\n            <span class=\"px-4\">{option.value}</span>\n            {#if displaySuffix && option.suffix}\n              <span class=\"text-subtle-2\">{option.suffix}</span>\n            {/if}\n          </button>\n        {/each}\n      {:else}\n        <slot name=\"right-empty\" />\n      {/if}\n    </div>\n  </div>\n</div>\n"],"names":["insert","target","slot","anchor","each_value_1","ctx","i","t_value","span","dirty","set_data","t","t1_value","create_if_block_3","input","input_checked_value","attr","button","button_class_value","cx","append","t1","each_value","create_if_block_1","create_if_block_2","create_if_block","button0","button0_class_value","button1","button1_class_value","div5","div5_class_value","div1","span0","div0","div2","i0","i1","div4","span1","div3","LEFT","RIGHT","disabled","$$props","left","right","leftlabel","rightlabel","height","suffix","dispatch","dispatcher","isDisabled","displaySuffix","htmlToBoolean","generateOption","initial","split","options","val","afterUpdate","allValues","opt","newLeftOptions","newRightOptions","newOptions","$$invalidate","addStyles","handleOptionClick","option","side","handleMoveClick","source","click_handler_1","click_handler_2"],"mappings":"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"}